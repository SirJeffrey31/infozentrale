<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gunterswiler AG - Info-Zentrale</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            height: 100vh;
            color: #fff;
            overflow: hidden;
        }

        .header {
            background: rgba(255,255,255,0.1);
            padding: 8px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #4ade80;
            height: 60px;
        }

        .logo {
            font-size: 22px;
            font-weight: bold;
            color: #4ade80;
        }

        .logo span {
            color: #fff;
        }

        .logo-subtitle {
            font-size: 11px;
            font-weight: normal;
            opacity: 0.7;
        }

        .header-center {
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .weather {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.08);
            padding: 10px 20px;
            border-radius: 12px;
        }

        .weather-icon {
            font-size: 40px;
        }

        .weather-info {
            text-align: left;
        }

        .weather-temp {
            font-size: 26px;
            font-weight: 600;
        }

        .weather-desc {
            font-size: 12px;
            opacity: 0.7;
        }

        .weather-forecast {
            display: flex;
            gap: 12px;
            margin-left: 15px;
            padding-left: 20px;
            border-left: 1px solid rgba(255,255,255,0.2);
        }

        .forecast-item {
            text-align: center;
            font-size: 12px;
            opacity: 0.7;
        }

        .forecast-item .temp {
            font-size: 14px;
            font-weight: 600;
            opacity: 1;
        }

        .header-right {
            text-align: right;
        }

        .clock {
            font-size: 32px;
            font-weight: 300;
            letter-spacing: 2px;
        }

        .date {
            font-size: 12px;
            opacity: 0.7;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1.3fr 0.9fr 0.8fr;
            gap: 12px;
            padding: 12px;
            height: calc(100vh - 60px);
        }

        .section {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
        }

        .section-title .icon {
            width: 24px;
            height: 24px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .tours-section .icon { background: #3b82f6; }

        .tour-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 8px;
            flex: 1;
        }

        .tour-card {
            border-radius: 10px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            transition: transform 0.2s;
            position: relative;
        }

        .tour-card:hover { transform: scale(1.02); }

        .tour-card.status-kommissionieren {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.4), rgba(185, 28, 28, 0.4));
            border: 2px solid #ef4444;
        }

        .tour-card.status-ready {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.4), rgba(22, 163, 74, 0.4));
            border: 2px solid #22c55e;
        }

        .tour-card.status-unterwegs {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.4), rgba(37, 99, 235, 0.4));
            border: 2px solid #3b82f6;
        }

        .tour-card.empty {
            background: rgba(255,255,255,0.02);
            border: 2px dashed rgba(255,255,255,0.1);
        }

        .tour-name {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .driver-name {
            font-size: 12px;
            opacity: 0.9;
        }

        .tour-status-badge {
            margin-top: 6px;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-kommissionieren { background: #ef4444; color: #fff; }
        .badge-ready { background: #22c55e; color: #fff; }
        .badge-unterwegs { background: #3b82f6; color: #fff; }

        .lieferschein-notice {
            margin-top: 8px;
            font-size: 13px;
            font-weight: 700;
            color: #fff;
            background: rgba(0,0,0,0.4);
            padding: 6px 12px;
            border-radius: 8px;
            animation: pulse-notice 1.5s infinite;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        @keyframes pulse-notice {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .middle-column {
            display: flex;
            flex-direction: column;
            gap: 12px;
            height: 100%;
        }

        .ranking-section {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .ranking-section .icon { background: #f59e0b; }

        .ranking-content {
            display: flex;
            flex-direction: column;
            gap: 6px;
            flex: 1;
            overflow: hidden;
        }

        .ranking-top3 {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .ranking-card {
            border-radius: 10px;
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
        }

        .ranking-card.rank-1 {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.3), rgba(217, 119, 6, 0.3));
            border: 2px solid #f59e0b;
        }

        .ranking-card.rank-2 {
            background: linear-gradient(135deg, rgba(156, 163, 175, 0.25), rgba(107, 114, 128, 0.25));
            border: 2px solid #9ca3af;
        }

        .ranking-card.rank-3 {
            background: linear-gradient(135deg, rgba(180, 83, 9, 0.25), rgba(146, 64, 14, 0.25));
            border: 2px solid #b45309;
        }

        .ranking-card.abwesend {
            opacity: 0.4;
            border-style: dashed;
        }

        .rank-badge {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 700;
            flex-shrink: 0;
        }

        .rank-1 .rank-badge { background: #f59e0b; color: #000; }
        .rank-2 .rank-badge { background: #9ca3af; color: #000; }
        .rank-3 .rank-badge { background: #b45309; color: #fff; }

        .ranking-card .ranking-info { flex: 1; }

        .ranking-card .driver-name {
            font-size: 15px;
            font-weight: 600;
            opacity: 1;
        }

        .ranking-card .tour-info {
            font-size: 11px;
            opacity: 0.7;
        }

        .abwesend-badge {
            font-size: 10px;
            background: rgba(255,255,255,0.2);
            padding: 2px 8px;
            border-radius: 6px;
        }

        .ranking-list {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
            overflow-y: auto;
        }

        .ranking-item {
            background: rgba(255,255,255,0.05);
            border-radius: 6px;
            padding: 6px 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-shrink: 0;
        }

        .ranking-item.abwesend { opacity: 0.4; }

        .ranking-item .rank {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .ranking-item .driver {
            flex: 1;
            font-weight: 500;
            font-size: 12px;
        }

        .ranking-item .tour {
            font-size: 10px;
            opacity: 0.6;
        }

        .ranking-item .abwesend-icon { font-size: 12px; }

        .spielregeln-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .spielregeln-section .icon { background: #8b5cf6; }

        .spielregeln-list {
            display: flex;
            flex-direction: column;
            gap: 6px;
            flex: 1;
            overflow-y: auto;
        }

        .regel-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            border-left: 4px solid;
            flex-shrink: 0;
        }

        .regel-item.regel-1 { border-left-color: #3b82f6; }
        .regel-item.regel-2 { border-left-color: #4ade80; }
        .regel-item.regel-3 { border-left-color: #f59e0b; }
        .regel-item.regel-4 { border-left-color: #ec4899; }
        .regel-item.regel-5 { border-left-color: #ef4444; }
        .regel-item.regel-6 { border-left-color: #8b5cf6; }

        .regel-icon {
            font-size: 18px;
            flex-shrink: 0;
            width: 24px;
            text-align: center;
        }

        .regel-content { flex: 1; }

        .regel-title {
            font-size: 13px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 2px;
        }

        .regel-text {
            font-size: 11px;
            opacity: 0.8;
            line-height: 1.3;
        }

        .spielregeln-footer {
            margin-top: 8px;
            padding: 10px;
            background: linear-gradient(135deg, rgba(74, 222, 128, 0.2), rgba(59, 130, 246, 0.2));
            border-radius: 8px;
            text-align: center;
            flex-shrink: 0;
        }

        .spielregeln-footer .motto {
            font-size: 13px;
            font-weight: 600;
            color: #4ade80;
        }

        .spielregeln-footer .subtitle {
            font-size: 10px;
            opacity: 0.7;
            margin-top: 2px;
        }

        .news-section .icon { background: #ec4899; }

        .news-grid {
            display: flex;
            flex-direction: column;
            gap: 10px;
            flex: 1;
        }

        .news-card {
            flex: 1;
            background: rgba(255,255,255,0.08);
            border-radius: 10px;
            padding: 12px;
            display: flex;
            gap: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            overflow: hidden;
        }

        .news-card.birthday {
            background: linear-gradient(135deg, rgba(236, 72, 153, 0.15), rgba(168, 85, 247, 0.15));
            border-color: rgba(236, 72, 153, 0.3);
        }

        .news-card.info {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(34, 211, 238, 0.15));
            border-color: rgba(59, 130, 246, 0.3);
        }

        .news-card.product {
            background: linear-gradient(135deg, rgba(74, 222, 128, 0.15), rgba(34, 197, 94, 0.15));
            border-color: rgba(74, 222, 128, 0.3);
        }

        .news-image {
            width: 70px;
            height: 70px;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            overflow: hidden;
        }

        .news-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .news-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .news-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 5px;
            width: fit-content;
        }

        .badge-birthday { background: #ec4899; }
        .badge-info { background: #3b82f6; }
        .badge-product { background: #4ade80; color: #000; }

        .news-title {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 3px;
        }

        .news-text {
            font-size: 12px;
            opacity: 0.8;
            line-height: 1.4;
        }

        .news-card.empty {
            background: rgba(255,255,255,0.02);
            border: 1px dashed rgba(255,255,255,0.1);
            align-items: center;
            justify-content: center;
        }

        .news-card.empty .placeholder-text {
            opacity: 0.3;
            font-size: 12px;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">
            GUNTERSWILER <span>AG</span>
            <div class="logo-subtitle">Info-Zentrale</div>
        </div>

        <div class="header-center">
            <div class="weather">
                <span class="weather-icon" id="weatherIcon">‚õÖ</span>
                <div class="weather-info">
                    <div class="weather-temp" id="weatherTemp">--¬∞C</div>
                    <div class="weather-desc" id="weatherDesc">Laden...</div>
                </div>
                <div class="weather-forecast" id="weatherForecast">
                    <div class="forecast-item">
                        <div>--:--</div>
                        <div class="temp">--¬∞</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="header-right">
            <div class="clock" id="clock">--:--</div>
            <div class="date" id="date">Laden...</div>
        </div>
    </header>

    <main class="main-content">
        <section class="section tours-section">
            <h2 class="section-title">
                <span class="icon">üöö</span>
                Touren Status
            </h2>
            <div class="tour-grid" id="tourGrid">
                <div class="loading">Laden...</div>
            </div>
        </section>

        <div class="middle-column">
            <section class="section ranking-section">
                <h2 class="section-title">
                    <span class="icon">üìã</span>
                    Nachlieferungs-Reihenfolge
                </h2>
                <div class="ranking-content">
                    <div class="ranking-top3" id="rankingTop3"></div>
                    <div class="ranking-list" id="rankingList"></div>
                </div>
            </section>

            <section class="section spielregeln-section">
                <h2 class="section-title">
                    <span class="icon">üìñ</span>
                    Spielregeln
                </h2>
                <div class="spielregeln-list">
                    <div class="regel-item regel-1">
                        <span class="regel-icon">üìã</span>
                        <div class="regel-content">
                            <div class="regel-title">Regel 1: Rotation gilt immer</div>
                            <div class="regel-text">Wer oben auf der Liste steht, macht die n√§chste Nachlieferung. Keine Ausnahmen, keine Diskussionen.</div>
                        </div>
                    </div>
                    <div class="regel-item regel-2">
                        <span class="regel-icon">‚úÖ</span>
                        <div class="regel-content">
                            <div class="regel-title">Regel 2: Nach der Fahrt</div>
                            <div class="regel-text">Wer eine Nachlieferung gemacht hat, wird durchgestrichen und wandert automatisch ans Ende der Liste.</div>
                        </div>
                    </div>
                    <div class="regel-item regel-3">
                        <span class="regel-icon">üè†</span>
                        <div class="regel-content">
                            <div class="regel-title">Regel 3: Bei Abwesenheit</div>
                            <div class="regel-text">Wer krank/frei ist, wird √ºbersprungen. Nach der R√ºckkehr gleiche Position wie vorher.</div>
                        </div>
                    </div>
                    <div class="regel-item regel-4">
                        <span class="regel-icon">üí¨</span>
                        <div class="regel-content">
                            <div class="regel-title">Regel 4: Proaktiv sein</div>
                            <div class="regel-text">Wer auf Platz 1-3 steht, fragt vor Feierabend kurz nach: "Kommt noch was?"</div>
                        </div>
                    </div>
                    <div class="regel-item regel-5">
                        <span class="regel-icon">‚ö†Ô∏è</span>
                        <div class="regel-content">
                            <div class="regel-title">Regel 5: Mehrere Nachlieferungen</div>
                            <div class="regel-text">Bei mehreren Nachlieferungen am gleichen Tag: Platz 1 nimmt die erste, Platz 2 die zweite, etc.</div>
                        </div>
                    </div>
                    <div class="regel-item regel-6">
                        <span class="regel-icon">üîí</span>
                        <div class="regel-content">
                            <div class="regel-title">Regel 6: Liste ist heilig</div>
                            <div class="regel-text">Nur die Gesch√§ftsleitung darf die Liste √§ndern. Manipulation = Abmahnung.</div>
                        </div>
                    </div>
                </div>
                <div class="spielregeln-footer">
                    <div class="motto">ü§ù Teamwork macht's m√∂glich!</div>
                    <div class="subtitle">Fair. Transparent. F√ºr alle.</div>
                </div>
            </section>
        </div>

        <section class="section news-section">
            <h2 class="section-title">
                <span class="icon">üì¢</span>
                News & Infos
            </h2>
            <div class="news-grid" id="newsGrid">
                <div class="loading">Laden...</div>
            </div>
        </section>
    </main>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        // Firebase Konfiguration
        const firebaseConfig = {
            apiKey: "AIzaSyAJIPZpX0ML_ahRqYGaysybxBHpbWKYspI",
            authDomain: "infozentrale-7b690.firebaseapp.com",
            projectId: "infozentrale-7b690",
            storageBucket: "infozentrale-7b690.firebasestorage.app",
            messagingSenderId: "634159156585",
            appId: "1:634159156585:web:deb48910b3f42d4e5081f8",
            measurementId: "G-LXS5T04D2F"
        };

        // Firebase initialisieren
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Konstanten
        const TOUR_NAMEN = [
            "Aadorf", "Uster", "Weinfelden", "Winterthur", "Schaffhausen",
            "Frauenfeld Fr√ºh", "Test", "Nahe Umgebung", "Klettgau",
            "Stein am Rhein", "Frauenfeld Sp√§t"
        ];

        // ==================== RENDER FUNKTIONEN ====================
        function renderTouren(touren) {
            const grid = document.getElementById('tourGrid');
            let html = '';
            
            for (let i = 0; i < 12; i++) {
                const tour = touren[i];
                
                if (tour && tour.name) {
                    const statusClass = `status-${tour.status}`;
                    const badgeClass = `badge-${tour.status}`;
                    const statusText = tour.status === 'kommissionieren' ? 'Kommissionieren' :
                                      tour.status === 'ready' ? 'READY' : 'Unterwegs';
                    
                    const lieferscheinHtml = tour.status === 'ready' 
                        ? '<div class="lieferschein-notice">üìÑ Lieferscheine bereit</div>' 
                        : '';
                    
                    html += `
                        <div class="tour-card ${statusClass}">
                            <div class="tour-name">${tour.name}</div>
                            <div class="driver-name">${tour.fahrer || '-'}</div>
                            <span class="tour-status-badge ${badgeClass}">${statusText}</span>
                            ${lieferscheinHtml}
                        </div>
                    `;
                } else {
                    html += `<div class="tour-card empty"></div>`;
                }
            }
            
            grid.innerHTML = html;
        }

        function renderRangliste(rangliste) {
            const top3Container = document.getElementById('rankingTop3');
            const listContainer = document.getElementById('rankingList');
            
            if (!rangliste || rangliste.length === 0) {
                top3Container.innerHTML = '<div class="loading">Keine Daten</div>';
                listContainer.innerHTML = '';
                return;
            }
            
            const top3 = rangliste.slice(0, 3);
            top3Container.innerHTML = top3.map((item, index) => {
                const abwesendClass = item.abwesend ? 'abwesend' : '';
                const abwesendBadge = item.abwesend ? '<span class="abwesend-badge">üè† Abwesend</span>' : '';
                
                return `
                    <div class="ranking-card rank-${index + 1} ${abwesendClass}">
                        <span class="rank-badge">${index + 1}</span>
                        <div class="ranking-info">
                            <div class="driver-name">${item.fahrer}</div>
                            <div class="tour-info">${item.tour}</div>
                        </div>
                        ${abwesendBadge}
                    </div>
                `;
            }).join('');
            
            const rest = rangliste.slice(3);
            listContainer.innerHTML = rest.map((item, index) => {
                const abwesendClass = item.abwesend ? 'abwesend' : '';
                const abwesendIcon = item.abwesend ? '<span class="abwesend-icon">üè†</span>' : '';
                
                return `
                    <div class="ranking-item ${abwesendClass}">
                        <span class="rank">${index + 4}</span>
                        <span class="driver">${item.fahrer}</span>
                        <span class="tour">${item.tour}</span>
                        ${abwesendIcon}
                    </div>
                `;
            }).join('');
        }

        function renderNews(news) {
            const grid = document.getElementById('newsGrid');
            let html = '';
            
            if (!news) news = [];
            
            for (let i = 0; i < 2; i++) {
                const item = news[i];
                
                if (item) {
                    const imageContent = item.bild 
                        ? `<img src="${item.bild}" alt="${item.titel}">`
                        : item.emoji || 'üì¢';
                    
                    html += `
                        <div class="news-card ${item.typ}">
                            <div class="news-image">${imageContent}</div>
                            <div class="news-content">
                                <span class="news-badge badge-${item.typ}">${item.typ}</span>
                                <div class="news-title">${item.titel}</div>
                                <div class="news-text">${item.text}</div>
                            </div>
                        </div>
                    `;
                } else {
                    html += `
                        <div class="news-card empty">
                            <span class="placeholder-text">Keine News</span>
                        </div>
                    `;
                }
            }
            
            grid.innerHTML = html;
        }

        // ==================== FIREBASE ECHTZEIT-LISTENER ====================
        function setupRealtimeListeners() {
            // Touren listener
            db.collection('settings').doc('touren').onSnapshot((doc) => {
                if (doc.exists) {
                    renderTouren(doc.data().list || []);
                } else {
                    // Erstelle Default-Daten
                    const defaultTouren = TOUR_NAMEN.map((name, i) => ({
                        name: name,
                        fahrer: `Chauffeur ${i + 1}`,
                        status: 'kommissionieren'
                    }));
                    renderTouren(defaultTouren);
                }
            });

            // Rangliste listener
            db.collection('settings').doc('rangliste').onSnapshot((doc) => {
                if (doc.exists) {
                    renderRangliste(doc.data().list || []);
                } else {
                    const defaultRangliste = Array.from({length: 11}, (_, i) => ({
                        fahrer: `Chauffeur ${i + 1}`,
                        tour: TOUR_NAMEN[i] || '',
                        abwesend: false
                    }));
                    renderRangliste(defaultRangliste);
                }
            });

            // News listener
            db.collection('settings').doc('news').onSnapshot((doc) => {
                if (doc.exists) {
                    renderNews(doc.data().list || []);
                } else {
                    renderNews([]);
                }
            });
        }

        // ==================== UHR & WETTER ====================
        function updateClock() {
            const now = new Date();
            const time = now.toLocaleTimeString('de-CH', { hour: '2-digit', minute: '2-digit' });
            const date = now.toLocaleDateString('de-CH', { 
                weekday: 'long', 
                day: 'numeric', 
                month: 'long', 
                year: 'numeric' 
            });
            document.getElementById('clock').textContent = time;
            document.getElementById('date').textContent = date;
        }

        async function loadWeather() {
            try {
                const lat = 47.55;
                const lon = 8.90;
                const response = await fetch(
                    `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,weather_code&hourly=temperature_2m&timezone=Europe/Zurich&forecast_days=1`
                );
                const weatherData = await response.json();
                
                const currentTemp = Math.round(weatherData.current.temperature_2m);
                const weatherCode = weatherData.current.weather_code;
                
                document.getElementById('weatherTemp').textContent = `${currentTemp}¬∞C`;
                document.getElementById('weatherIcon').textContent = getWeatherIcon(weatherCode);
                document.getElementById('weatherDesc').textContent = getWeatherDescription(weatherCode);
                
                const now = new Date();
                const currentHour = now.getHours();
                const forecastHours = [currentHour + 2, currentHour + 4, currentHour + 6].map(h => h % 24);
                
                const forecastHtml = forecastHours.map(hour => {
                    const temp = Math.round(weatherData.hourly.temperature_2m[hour] || currentTemp);
                    return `
                        <div class="forecast-item">
                            <div>${hour.toString().padStart(2, '0')}:00</div>
                            <div class="temp">${temp}¬∞</div>
                        </div>
                    `;
                }).join('');
                
                document.getElementById('weatherForecast').innerHTML = forecastHtml;
                
            } catch (error) {
                console.error('Wetter konnte nicht geladen werden:', error);
                document.getElementById('weatherDesc').textContent = 'Nicht verf√ºgbar';
            }
        }

        function getWeatherIcon(code) {
            if (code === 0) return '‚òÄÔ∏è';
            if (code <= 3) return '‚õÖ';
            if (code <= 49) return 'üå´Ô∏è';
            if (code <= 69) return 'üåßÔ∏è';
            if (code <= 79) return 'üå®Ô∏è';
            if (code <= 99) return '‚õàÔ∏è';
            return '‚òÅÔ∏è';
        }

        function getWeatherDescription(code) {
            if (code === 0) return 'Sonnig';
            if (code <= 3) return 'Teilweise bew√∂lkt';
            if (code <= 49) return 'Nebel';
            if (code <= 59) return 'Nieselregen';
            if (code <= 69) return 'Regen';
            if (code <= 79) return 'Schnee';
            if (code <= 99) return 'Gewitter';
            return 'Bew√∂lkt';
        }

        // ==================== INIT ====================
        setupRealtimeListeners();
        updateClock();
        loadWeather();
        setInterval(updateClock, 1000);
        setInterval(loadWeather, 600000);
    </script>
</body>
</html>
